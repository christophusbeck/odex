{% extends 'layout.html' %}

{% block content %}
    <div class="configuration">
        <h1 align="center">New Run:</h1>
        <br>
        Run title: {{ exp_Info.run_name }}
        <br>
        Detected subspaces: {{ exp_Info.amount_detected_subspace }}


        <table class="table table-bordered" align="center" border="1">
            <thead>
            <tr>
                <th>Subspaces on *.csv</th>
                <th>Indexing</th>
            </tr>
            </thead>
            <tbody>

            {% for para in exp_Info.columns %}
                <tr>
                    <td>{{ para }}</td>
                    <td>{{ para.id }}</td>
                </tr>
            {% endfor %}

            <br>
        </table>
        <br>


        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <br>
            <div class="operation">
                {{ form.operation_model }}
                {#                it should be a text input#}
                <div class="form-group">
                    <label>{{ upform.operation.label }}: </label>
                    {{ upform.operation }}
                    <span style="color: red;">{{ field.errors.0 }}</span>
                </div>


            </div>

            <div style="float: right ">
                <div>If use ground truth file:</div>
                <div>{{ form.ground_truth }}</div>

                <button class="ground_truth_file">
                    <label>{{ upform.ground_truth.label }}: </label>
                    {{ upform.ground_truth }}
                    <span style="color: red;">{{ field.errors.0 }}</span>
                </button>
            </div>


            <div>
                <p> {{ form.addtional_data }} Run again with additional data</p>

                <button class="addtional">
                    <label>{{ upform.add_data.label }}: </label>
                    {{ upform.add_data }}
                    <span style="color: red;">{{ field.errors.0 }}</span>
                </button>
                <br>
            </div>


            <br>
            Select Outlier Detection Method and input parameters:
            <label>
                <select id="odms" onchange="odm_paras()">
                    {% for key in odms %}
                        <option value="{{ forloop.counter }}"> {{ key }}
                    {% endfor %}
                </select>
            </label>


        {% load odms_para %}
            <script>
                function odm_paras() {
                    var options = $("#odms option:selected");
                    var odm = options.val();
                    var para_list = {{ odm|odm_para }}
                }

                var table = document.getElementById("parameters");

                for(var i=0; i<para_list.length();i++) {
                    var para = para_list[i];
                    var span = document.createElement("span");
                    span.innerText = "<td> para </td> <td><input type=\"text\"></td>";
                }
            </script>


            <table class="table table-bordered" align="center" border="1">
                <thead>
                <tr>
                    <th>parameters</th>
                    <th>values</th>
                </tr>
                </thead>
                <tbody id="parameters">
{#                {% for para in form.parameter %}#}
{#                    <td>{{ para }}</td>#}
{#                    <td><input type="text"></td>#}
{#                {% endfor %}#}
                </tbody>
            </table>


            <div>
                <br>
                <a href="/main/" style="margin-right: 500px">
                    <button type="button" value="cancel">Cancel</button>
                </a>

                <a href="/main/">
                    <button type="submit" value="Add run to queue">Add run to queue</button>
                </a>
            </div>
        </form>

    </div>


{% endblock %}